# Windows Services Lab

In this lab I explored how Windows services function, how they can be managed using GUI and command line tools, and how service misconfigurations can be exploited for privilege escalation. I used the Service Control Manager (SCM), PowerShell, and WMIC to inspect, control, and demonstrate potential service vulnerabilities.

---

## What I Learned

- How to view and manage Windows services using the Services GUI, PowerShell, and WMIC
- Key differences between service name and display name
- What service properties like `Startup Type`, `Status`, and `Log On As` mean
- How to find services with unquoted paths that may be vulnerable
- How to simulate an unquoted path attack using `EvilWindowsService.exe`

---

## ðŸ§µ Tools & Commands Used

| Tool        | Purpose |
|-------------|---------|
| `services.msc` | View and manage services with GUI |
| PowerShell `Get-Service`, `Start-Service`, `Stop-Service` | Manage services via command line |
| `WMIC`      | View detailed service metadata, including executable paths |
| `eventvwr.msc` | View application logs generated by services |
| `New-Service` | Create a new service with a custom binary |
| `mkdir`, `copy`, `type` | File manipulation and setup |

---

## Key Concepts

### Windows Services Overview
- Run in the background, often without user interaction
- Can auto start, start manually, or be disabled
- Run with powerful privileges, often as `LocalSystem`
- Each service has a Display Name and a Service Name 

### Service Attack Vectors
- **Unquoted service paths** = spaces in executable paths without `"` allow malicious binaries (like `C:\Program.exe`) to hijack service startup
- **User writable service paths** = replacing service binaries if directory permissions are too lax
- **User-modifiable paths** = attackers can unregister and re register services with hostile executables

---

##  Part 1: GUI Management with Service Control Manager

- Opened `services.msc`
- Explored tabs:
  - **General** â€“ shows path to executable, startup type, and service status
  - **Log On** â€“ service credentials (usually `LocalSystem`)
  - **Recovery** â€“ what happens if a service fails
  - **Dependencies** â€“ which services must run before/after
---

##  Part 2: PowerShell & WMIC

- `Get-Service` â€” listed all services
- `Get-Service | Where-Object Status -EQ "Running"` â€” filtered running services
- `wmic service get name,pathname` â€” showed executable paths
- Used filters like:
  - `Started=True` or `Started=False`
  - Showed full info: `get name,displayname,started,processid,pathname`

---

## Part 3: Unquoted Service Path Attack Demo

### Setup
```powershell
cd C:\Users\cybrary\Desktop
mkdir "C:\Program Files\my service"
copy WindowsService1.exe "C:\Program Files\my service"
New-Service -Name MyService -BinaryPathName "C:\Program Files\my service\WindowsService1.exe"
Start-Service -Name MyService
